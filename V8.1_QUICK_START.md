# V8.1 å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸš€ ç«‹å³å¼€å§‹

### Windows
åŒå‡»è¿è¡Œï¼š
```
start_v8.1_training.bat
```

### Linux/Mac
```bash
python train_v8.1_local.py
```

## âœ¨ V8.1 æ–°ç‰¹æ€§

### 1ï¸âƒ£ æ¯ä¸ª epoch è®¡ç®— Kaggle F1
- âœ… ä¸å†åªçœ‹å‡†ç¡®ç‡
- âœ… ç›´æ¥ä¼˜åŒ– Kaggle è¯„åˆ†æŒ‡æ ‡
- âœ… Early stopping åŸºäº Kaggle F1

### 2ï¸âƒ£ æ™ºèƒ½æ¨¡å‹ä¿å­˜
3 ä¸ªæ¨¡å‹æ–‡ä»¶ï¼š
- `best_model.pth` - **Kaggle F1 æœ€é«˜** â† ç”¨äºæäº¤
- `best_model_acc.pth` - å¸§å‡†ç¡®ç‡æœ€é«˜
- `last_model.pth` - æœ€æ–°æ£€æŸ¥ç‚¹

### 3ï¸âƒ£ è¿åŠ¨é—¨æ§ï¼ˆMotion Gatingï¼‰
è‡ªåŠ¨è¿‡æ»¤ä¸ç¬¦åˆè¿åŠ¨ç‰¹å¾çš„é¢„æµ‹ï¼š
- **escape/chase**: å¿…é¡»é«˜é€Ÿï¼ˆâ‰¥80 px/sï¼‰
- **freeze**: å¿…é¡»ä½é€Ÿï¼ˆâ‰¤7 px/sï¼‰

### 4ï¸âƒ£ ç²¾è°ƒé˜ˆå€¼
é’ˆå¯¹æ¯ä¸ªè¡Œä¸ºç±»åˆ«ä¼˜åŒ–ï¼š
- sniff: æ§åˆ¶è¯¯æŠ¥ (â†‘ 0.50)
- sniffgenital: æå‡å¬å› (â†“ 0.26)
- intromit: æå‡ç²¾åº¦ (â†‘ 0.45)
- escape: ä¸¥æ ¼ + é€Ÿåº¦é—¨æ§

## ğŸ“Š è®­ç»ƒè¾“å‡º

æ¯ä¸ª epoch ä½ ä¼šçœ‹åˆ°ï¼š
```
[Kaggle] Interval F1: 0.6523 | Precision: 0.6891 | Recall: 0.6201
[OK] Saved best Kaggle F1 model (kaggle_f1=0.6523)
```

**Kaggle F1** æ˜¯æœ€é‡è¦çš„æŒ‡æ ‡ï¼

## â±ï¸ é¢„è®¡æ—¶é—´

- æ¯ä¸ª epoch: ~2.5 åˆ†é’Ÿï¼ˆè®­ç»ƒ 2 åˆ†é’Ÿ + éªŒè¯ 30 ç§’ï¼‰
- é¢„è®¡è®­ç»ƒ: 30-50 epochsï¼ˆæ—©åœï¼‰
- æ€»æ—¶é—´: **1-2 å°æ—¶**

## ğŸ“ˆ é¢„æœŸæ€§èƒ½

ç›¸æ¯” V8ï¼š
- Escape FP: **-30~50%**ï¼ˆé€Ÿåº¦é—¨æ§ï¼‰
- Freeze Recall: **+10~20%**ï¼ˆé˜ˆå€¼æ”¾å®½ï¼‰
- Intromit Precision: **+5~10%**ï¼ˆé˜ˆå€¼æå‡ï¼‰
- æ•´ä½“ F1: **+2~5%**

## ğŸ¯ è®­ç»ƒå®Œæˆå

### 1. æŸ¥çœ‹æœ€ä½³æ¨¡å‹
```bash
ls -lh checkpoints/v8.1_optimized/best_model.pth
```

### 2. è¿è¡Œæ¨ç†
```bash
python inference_v8.1.py \
  --checkpoint checkpoints/v8.1_optimized/best_model.pth \
  --output submission_v8.1.csv
```

### 3. æäº¤åˆ° Kaggle
```bash
python submit_to_kaggle.py submission_v8.1.csv
```

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆéªŒè¯æ¯”ä»¥å‰æ…¢ï¼Ÿ
A: æ¯ä¸ª epoch éƒ½è®¡ç®—å®Œæ•´çš„ Kaggle F1ï¼ˆåŒ…æ‹¬åå¤„ç†ï¼‰ï¼Œä½†è¿™ä¿è¯äº†æ¨¡å‹ä¼˜åŒ–æ–¹å‘æ­£ç¡®ã€‚

### Q: å¯ä»¥é™ä½éªŒè¯é¢‘ç‡å—ï¼Ÿ
A: ä¸æ¨èã€‚Kaggle F1 æ‰æ˜¯çœŸæ­£çš„ç›®æ ‡ï¼Œå¿…é¡»æ¯è½®ç›‘æ§ã€‚

### Q: best_model.pth å’Œ best_model_acc.pth æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
A:
- `best_model.pth`: Kaggle F1 æœ€é«˜ â† **ç”¨è¿™ä¸ªæäº¤**
- `best_model_acc.pth`: å¸§å‡†ç¡®ç‡æœ€é«˜ï¼ˆå¯èƒ½è¿‡æ‹Ÿåˆï¼‰

### Q: è®­ç»ƒå¡åœ¨æŸä¸ª F1 å€¼ï¼Ÿ
A: æ­£å¸¸ï¼Œå¯èƒ½éœ€è¦æ›´å¤š epochã€‚Early stopping ä¼šåœ¨ 20 è½®æ— æå‡åè‡ªåŠ¨åœæ­¢ã€‚

## ğŸ”§ é«˜çº§é€‰é¡¹

### è°ƒæ•´é€Ÿåº¦é˜ˆå€¼
ç¼–è¾‘ `versions/v8_1_optimized_postproc/advanced_postprocessing.py`:
```python
'escape': {
    'velocity_min': 60.0  # é™ä½é˜ˆå€¼ï¼Œæ›´å®½æ¾ï¼ˆé»˜è®¤ 80ï¼‰
}
```

### è°ƒæ•´ç±»åˆ«é˜ˆå€¼
åŒä¸Šæ–‡ä»¶ä¸­çš„ `CLASS_CONFIG` å­—å…¸

### è°ƒæ•´è®­ç»ƒå‚æ•°
ç¼–è¾‘ `configs/config_v8.1_optimized.yaml`

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿè¿è¡Œ `start_v8.1_training.bat` å¼€å§‹è®­ç»ƒï¼** ğŸš€
