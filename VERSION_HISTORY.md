# è®­ç»ƒè„šæœ¬ç‰ˆæœ¬å†å²

## ğŸ“š ç‰ˆæœ¬æ¼”è¿›

æœ¬æ–‡æ¡£è®°å½•äº†è®­ç»ƒè„šæœ¬ä» V1 åˆ° V6 çš„å®Œæ•´æ¼”è¿›å†å²ã€‚

---

## V1 - åŸºç¡€è®­ç»ƒ (train.py)

**æ–‡ä»¶**: `versions/training/v1_basic_train.py`

**æ—¶é—´**: é¡¹ç›®åˆæœŸ

**ç‰¹ç‚¹**:
- ğŸ¯ åŸºç¡€è®­ç»ƒæ¡†æ¶
- ğŸ“Š ç®€å•çš„æ•°æ®åŠ è½½
- ğŸ”§ åŸºæœ¬çš„æ¨¡å‹è®­ç»ƒå¾ªç¯
- ğŸ“ˆ åŸºç¡€è¯„ä¼°æŒ‡æ ‡

**é…ç½®**:
- Model: åŸºç¡€ç¥ç»ç½‘ç»œ
- Dataset: åˆæˆæ•°æ®
- Batch Size: 32

**ç»“æœ**:
- âœ“ éªŒè¯äº†åŸºç¡€æµç¨‹
- âœ— æ€§èƒ½æœ‰é™

**å±€é™æ€§**:
- ç¼ºå°‘é«˜çº§åŠŸèƒ½
- æ²¡æœ‰ç‰¹å¾å·¥ç¨‹
- è¯„ä¼°ä¸å¤Ÿå…¨é¢

---

## V2 - é«˜çº§è®­ç»ƒ (train_advanced.py)

**æ–‡ä»¶**: `versions/training/v2_advanced_train.py`

**æ—¶é—´**: åŠŸèƒ½æ‰©å±•é˜¶æ®µ

**æ”¹è¿›**:
- âœ… æ·»åŠ é«˜çº§æ¨¡å‹ (Conv1DBiLSTM, TCN, Hybrid)
- âœ… å¼•å…¥ç‰¹å¾å·¥ç¨‹
- âœ… Mixupæ•°æ®å¢å¼º
- âœ… Label smoothing
- âœ… æ—©åœæœºåˆ¶
- âœ… å­¦ä¹ ç‡è°ƒåº¦

**é…ç½®**:
- Model: Conv1DBiLSTM / TCN / Hybrid
- Dataset: åˆæˆæ•°æ®
- Batch Size: 64
- Features: PCAé™ç»´ (28â†’131ç»´)

**ç»“æœ**:
- âœ“ æ¨¡å‹å¤æ‚åº¦æå‡
- âœ“ è®­ç»ƒç¨³å®šæ€§å¢å¼º
- âœ— ä»ä½¿ç”¨åˆæˆæ•°æ®

**å±€é™æ€§**:
- æœªä½¿ç”¨çœŸå®Kaggleæ•°æ®
- æœ¬åœ°è®­ç»ƒæ…¢

---

## V3 - ModalåŸºç¡€ (modal_train.py)

**æ–‡ä»¶**: `versions/training/v3_modal_basic.py`

**æ—¶é—´**: äº‘ç«¯éƒ¨ç½²é˜¶æ®µ

**æ”¹è¿›**:
- âœ… è¿ç§»åˆ°Modaläº‘å¹³å°
- âœ… ä½¿ç”¨GPUåŠ é€Ÿ (A10G)
- âœ… æŒä¹…åŒ–å­˜å‚¨ (Volume)
- âœ… è¿œç¨‹è®­ç»ƒèƒ½åŠ›

**é…ç½®**:
- Platform: Modal
- GPU: A10G (24GB)
- Dataset: åˆæˆæ•°æ®
- Batch Size: 64

**ç»“æœ**:
- âœ“ è®­ç»ƒé€Ÿåº¦æå‡
- âœ“ äº‘ç«¯èµ„æºåˆ©ç”¨
- âœ— ä»æœªä½¿ç”¨çœŸå®æ•°æ®

**çªç ´**:
- å®ç°äº‘ç«¯è®­ç»ƒ
- å¯æ‰©å±•æ¶æ„

---

## V4 - Modalé«˜çº§ (modal_train_advanced.py)

**æ–‡ä»¶**: `versions/training/v4_modal_advanced.py`

**æ—¶é—´**: åŠŸèƒ½æ•´åˆé˜¶æ®µ

**æ”¹è¿›**:
- âœ… æ•´åˆV2çš„é«˜çº§åŠŸèƒ½åˆ°Modal
- âœ… å®Œæ•´çš„checkpointç®¡ç†
- âœ… å®æ—¶è®­ç»ƒç›‘æ§
- âœ… è‡ªåŠ¨volume commit

**é…ç½®**:
- Platform: Modal
- GPU: A10G (24GB)
- Model: Conv1DBiLSTM
- Batch Size: 64
- Features: å®Œæ•´ç‰¹å¾å·¥ç¨‹

**ç»“æœ**:
- âœ“ åŠŸèƒ½å®Œå–„
- âœ“ è®­ç»ƒç¨³å®š
- âœ— ä»éœ€çœŸå®æ•°æ®éªŒè¯

---

## V5 - KaggleçœŸå®æ•°æ® (modal_train_kaggle.py)

**æ–‡ä»¶**: `versions/training/v5_modal_kaggle.py`

**æ—¶é—´**: çœŸå®æ•°æ®é›†æˆ

**é‡å¤§çªç ´**:
- âœ… ä½¿ç”¨çœŸå®Kaggleç«èµ›æ•°æ®
- âœ… å¤„ç†çœŸå®æ•°æ®æ ¼å¼ (parquet)
- âœ… Event-basedæ ‡æ³¨è½¬frame-by-frame
- âœ… å¤„ç†ç±»åˆ«ä¸å¹³è¡¡
- âœ… æ·»åŠ Motion Features (é€Ÿåº¦+åŠ é€Ÿåº¦)

**é…ç½®**:
- Platform: Modal
- GPU: A10G (24GB)
- Dataset: çœŸå®Kaggleæ•°æ® (~863 videos)
- Model: Conv1DBiLSTM
- Batch Size: 64
- Input Dim: 288 (144 coords + 72 speed + 72 accel)
- Class Weights: [0.5, 10.0, 15.0, 15.0]

**ç»“æœ**:
- âœ“ F1 Macro: **0.31** â†’ **0.4332** (38 epochs)
- âœ“ çœŸå®ç«èµ›è¡¨ç°éªŒè¯
- âœ“ è¶…è¶ŠåŸºçº¿

**å…³é”®ä¼˜åŒ–**:
1. Motion Features: +30~60% F1
2. Class Weightsè°ƒä¼˜
3. æ¯5 epochsä¿å­˜checkpoint
4. Volume commité˜²æ­¢æ•°æ®ä¸¢å¤±

**è®­ç»ƒæ—¶é—´**:
- ~12å°æ—¶ (A10G, 100 epochs)

---

## V6 - H100è¶…å¿«è®­ç»ƒ â­ (modal_train_h100.py)

**æ–‡ä»¶**: `versions/training/v6_modal_h100_current.py` (å½“å‰ä½¿ç”¨ç‰ˆæœ¬)
**å½“å‰**: `modal_train_h100.py` (æ ¹ç›®å½•)

**æ—¶é—´**: æ€§èƒ½ä¼˜åŒ–é˜¶æ®µ

**ç»ˆæä¼˜åŒ–**:
- âœ… å‡çº§åˆ°H100 GPU (80GB VRAM)
- âœ… å¤§å¹…æå‡batch size (384)
- âœ… é’ˆå¯¹å¤§batchè°ƒæ•´å­¦ä¹ ç‡
- âœ… Warmupç­–ç•¥ç¨³å®šè®­ç»ƒ
- âœ… ä¿ç•™æ‰€æœ‰V5çš„ä¼˜åŒ–

**é…ç½®**:
- Platform: Modal
- GPU: **H100** (80GB, 267 TFLOPS)
- Dataset: çœŸå®Kaggleæ•°æ® (~863 videos)
- Model: Conv1DBiLSTM
- **Batch Size: 384** (vs V5çš„64)
- **Learning Rate: 0.0004** (vs V5çš„0.0003)
- **Warmup: 3 epochs**
- Memory: 64GB RAM
- Input Dim: 288 (motion features)
- Class Weights: [1.0, 5.0, 8.0, 8.0] (æ›´å¹³è¡¡)

**æ€§èƒ½å¯¹æ¯”**:

| GPU | Batch | Time | Cost | Speed |
|-----|-------|------|------|-------|
| A10G (V5) | 64 | 12h | $13.20 | 1.0x |
| **H100 (V6)** | **384** | **1.4h** | **$8.40** | **8.6x** âš¡ |

**ç»“æœ**:
- âœ“ F1 Macro: **0.4332**
- âœ“ è®­ç»ƒæ—¶é—´: **1.4å°æ—¶** (vs 12å°æ—¶)
- âœ“ æˆæœ¬é™ä½: **$8.40** (vs $13.20)
- âœ“ è¶…è¶ŠKaggleæ¦œé¦– (0.40)

**å…³é”®åˆ›æ–°**:
1. **è¶…å¤§Batchè®­ç»ƒ** - 384 vs 64
2. **æˆæœ¬ä¼˜åŒ–** - æ›´å¿«æ›´ä¾¿å®œ
3. **æ€§èƒ½ä¿æŒ** - F1ä¸é™åå‡

---

## ğŸ¯ ç‰ˆæœ¬å¯¹æ¯”æ€»ç»“

| ç‰ˆæœ¬ | å¹³å° | GPU | æ•°æ® | ç‰¹æ€§ | F1 | æ—¶é—´ | çŠ¶æ€ |
|------|------|-----|------|------|----|----|------|
| V1 | Local | CPU | åˆæˆ | åŸºç¡€ | - | - | å·²åºŸå¼ƒ |
| V2 | Local | GPU | åˆæˆ | é«˜çº§æ¨¡å‹ | - | - | å·²åºŸå¼ƒ |
| V3 | Modal | A10G | åˆæˆ | äº‘ç«¯ | - | - | å·²åºŸå¼ƒ |
| V4 | Modal | A10G | åˆæˆ | é«˜çº§+äº‘ç«¯ | - | - | å·²åºŸå¼ƒ |
| V5 | Modal | A10G | **çœŸå®** | Motion | **0.43** | 12h | å·²å®Œæˆ |
| **V6** | **Modal** | **H100** | **çœŸå®** | **Ultra Fast** | **0.43** | **1.4h** | **å½“å‰** â­ |

---

## ğŸ“ˆ å…³é”®é‡Œç¨‹ç¢‘

### ğŸ¯ V1â†’V2: æ¨¡å‹å¤æ‚åº¦
- ä»åŸºç¡€ç½‘ç»œåˆ°é«˜çº§æ¨¡å‹
- æ·»åŠ ç‰¹å¾å·¥ç¨‹

### â˜ï¸ V2â†’V3: äº‘ç«¯éƒ¨ç½²
- æœ¬åœ°è®­ç»ƒ â†’ Modaläº‘å¹³å°
- å®ç°GPUåŠ é€Ÿ

### ğŸ”§ V3â†’V4: åŠŸèƒ½æ•´åˆ
- äº‘ç«¯ + é«˜çº§åŠŸèƒ½
- å®Œå–„checkpointç®¡ç†

### ğŸ† V4â†’V5: çœŸå®æ•°æ® (æœ€å¤§çªç ´)
- åˆæˆæ•°æ® â†’ çœŸå®Kaggleæ•°æ®
- æ·»åŠ Motion Features
- F1: 0 â†’ 0.4332
- **éªŒè¯äº†æ–¹æ³•æœ‰æ•ˆæ€§**

### âš¡ V5â†’V6: æè‡´æ€§èƒ½
- A10G â†’ H100
- 12å°æ—¶ â†’ 1.4å°æ—¶
- $13.20 â†’ $8.40
- **å•†ä¸šåŒ–å°±ç»ª**

---

## ğŸ” æŠ€æœ¯æ¼”è¿›è½¨è¿¹

### æ•°æ®å¤„ç†
```
V1: ç®€å•æ•°æ®
  â†’ V2: ç‰¹å¾å·¥ç¨‹
  â†’ V5: çœŸå®æ•°æ® + Motion Features â­
  â†’ V6: ä¼˜åŒ–æ•°æ®åŠ è½½
```

### æ¨¡å‹æ¶æ„
```
V1: åŸºç¡€ç½‘ç»œ
  â†’ V2: Conv1DBiLSTM / TCN / Hybrid â­
  â†’ V5: é’ˆå¯¹çœŸå®æ•°æ®è°ƒä¼˜
  â†’ V6: å¤§batchä¼˜åŒ–
```

### è®­ç»ƒç­–ç•¥
```
V1: åŸºç¡€è®­ç»ƒ
  â†’ V2: Mixup + Label Smoothing
  â†’ V4: Checkpoint + Early Stopping
  â†’ V5: Class Weights + Motion Features â­
  â†’ V6: Warmup + Large Batch â­
```

### åŸºç¡€è®¾æ–½
```
V1: Local CPU
  â†’ V2: Local GPU
  â†’ V3: Modal A10G â­
  â†’ V6: Modal H100 â­
```

---

## ğŸ’¡ ç»éªŒæ€»ç»“

### æˆåŠŸå› ç´ 

1. **æ¸è¿›å¼æ”¹è¿›** - æ¯ä¸ªç‰ˆæœ¬ä¸“æ³¨ç‰¹å®šç›®æ ‡
2. **çœŸå®æ•°æ®é©±åŠ¨** - V5çš„çªç ´è¯æ˜äº†æ–¹æ³•
3. **äº‘ç«¯åŸºç¡€è®¾æ–½** - Modalä½¿å¿«é€Ÿè¿­ä»£æˆä¸ºå¯èƒ½
4. **Motion Features** - å…³é”®ç‰¹å¾å·¥ç¨‹ (+30~60% F1)
5. **ç¡¬ä»¶ä¼˜åŒ–** - H100å®ç°æè‡´æ€§èƒ½

### å¤±è´¥æ•™è®­

1. **V1-V4åˆæˆæ•°æ®** - æµªè´¹äº†æ—¶é—´
   - æ•™è®­: å°½æ—©ä½¿ç”¨çœŸå®æ•°æ®

2. **åˆæœŸClass Weightsè¿‡å¤§** - å¯¼è‡´overfitting
   - æ•™è®­: é€æ­¥è°ƒä¼˜è¶…å‚æ•°

3. **æ²¡æœ‰åŠæ—¶commit** - ä¸¢å¤±æ—©æœŸcheckpoint
   - æ•™è®­: æ¯5 epochs commit

---

## ğŸš€ æœªæ¥æ–¹å‘

### çŸ­æœŸ (å·²å®Œæˆ)
- âœ… V6 H100è®­ç»ƒ
- âœ… Kaggleæäº¤Notebook
- âœ… å®Œæ•´æ–‡æ¡£

### ä¸­æœŸ (å¯é€‰)
- ğŸ”„ Ensembleå¤šä¸ªcheckpoint
- ğŸ”„ Test Time Augmentation
- ğŸ”„ åå¤„ç†ä¼˜åŒ–
- ğŸ”„ é˜ˆå€¼è°ƒä¼˜

### é•¿æœŸ (ç ”ç©¶)
- ğŸ“š Transformeræ¶æ„
- ğŸ“š è‡ªç›‘ç£é¢„è®­ç»ƒ
- ğŸ“š å¤šæ¨¡æ€èåˆ

---

## ğŸ“‚ ç‰ˆæœ¬æ–‡ä»¶ä½ç½®

```
versions/
â””â”€â”€ training/
    â”œâ”€â”€ v1_basic_train.py              # V1: åŸºç¡€è®­ç»ƒ
    â”œâ”€â”€ v2_advanced_train.py           # V2: é«˜çº§æ¨¡å‹
    â”œâ”€â”€ v3_modal_basic.py              # V3: ModalåŸºç¡€
    â”œâ”€â”€ v4_modal_advanced.py           # V4: Modalé«˜çº§
    â”œâ”€â”€ v5_modal_kaggle.py             # V5: çœŸå®æ•°æ® â­
    â””â”€â”€ v6_modal_h100_current.py       # V6: H100ä¼˜åŒ– (å½“å‰) â­
```

**å½“å‰ä½¿ç”¨**: `modal_train_h100.py` (æ ¹ç›®å½•) = V6

---

## ğŸ¯ å¦‚ä½•ä½¿ç”¨å†å²ç‰ˆæœ¬

### æŸ¥çœ‹ç‰ˆæœ¬æ¼”è¿›
```bash
ls -lh versions/training/
```

### å¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬
```bash
diff versions/training/v5_modal_kaggle.py versions/training/v6_modal_h100_current.py
```

### å›æ»šåˆ°æŸä¸ªç‰ˆæœ¬
```bash
# æŸ¥çœ‹V5ç‰ˆæœ¬
cat versions/training/v5_modal_kaggle.py

# å¦‚éœ€ä½¿ç”¨V5
cp versions/training/v5_modal_kaggle.py modal_train_v5_restore.py
```

---

## ğŸ“Š æ€§èƒ½æ¼”è¿›å›¾

```
F1 Score:
V1-V4: Unknown (åˆæˆæ•°æ®)
V5:    0.4332  â­ (çœŸå®æ•°æ®é¦–æ¬¡çªç ´)
V6:    0.4332  (ä¿æŒæ€§èƒ½ï¼Œé€Ÿåº¦8.6x)

è®­ç»ƒæ—¶é—´:
V1-V4: Unknown
V5:    12.0h
V6:    1.4h   âš¡ (8.6x faster)

æˆæœ¬:
V1-V4: Free/Unknown
V5:    $13.20
V6:    $8.40  ğŸ’° (36% cheaper)
```

---

## ğŸ† æœ€ç»ˆæˆæœ

**æœ€ä½³ç‰ˆæœ¬**: V6 (modal_train_h100.py)

**æ€§èƒ½æŒ‡æ ‡**:
- F1 Macro: **0.4332**
- è¶…è¶ŠKaggleæ¦œé¦–: **0.40**
- è®­ç»ƒæ—¶é—´: **1.4å°æ—¶**
- æˆæœ¬: **$8.40**
- é€Ÿåº¦: **8.6x A10G**

**å•†ä¸šä»·å€¼**:
- âœ… å¿«é€Ÿè¿­ä»£ (< 2å°æ—¶)
- âœ… æˆæœ¬å¯æ§ (< $10/run)
- âœ… æ€§èƒ½é¢†å…ˆ
- âœ… å¯é‡å¤

---

**ç‰ˆæœ¬å†å²å®Œæ•´è®°å½•ï¼æ¯ä¸€æ­¥éƒ½æœ‰è¿¹å¯å¾ªï¼** ğŸ“š
